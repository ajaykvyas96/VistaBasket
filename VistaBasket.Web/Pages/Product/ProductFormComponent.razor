@using VistaBasket.Web.IServices
@inject IProductService _productService
@inject ICategoryService _categoryService
@inject IBrandService _brandService

<p>@errorMessage</p>
<p>@successMessage</p>
<EditForm Model="@ProductDto" OnValidSubmit="HandleSubmit">
    <DataAnnotationsValidator />
    <div class="form-group">
        <label for="productname">Product name</label>
        <input type="text" class="form-control" id="categoryname" @bind="ProductDto.Name" />
        <ValidationMessage For="@(() => ProductDto.Name)" />
    </div>
    <div class="form-group">
        <label for="description">Product Description</label>
        <input type="text" class="form-control" id="description" @bind="ProductDto.Description" />
        <ValidationMessage For="@(() => ProductDto.Description)" />
    </div>
    <div class="form-group">
        <label for="productImage">Product Image:</label>
        <InputFile id="productImage" @bind-Value="ProductDto.ProductImage" OnChange="HandleFileUpload" class="form-control" />
        <ValidationMessage For="@(() => ProductDto.ProductImage)" />
    </div>
    <div class="form-group">
        <label for="price">Product Price</label>
        <input type="text" class="form-control" id="price" @bind="ProductDto.Price" />
        <ValidationMessage For="@(() => ProductDto.Price)" />
    </div>

    <div class="form-group">
        <label for="category">Category</label>

        <select @bind="ProductDto.CategoryId" class="form-control">
            <option value="">Select</option>
            @foreach (var category in categories)
            {
                <option value="@category.Id" selected="@ProductDto.CategoryId">@category.Name</option>
            }
        </select>
        <ValidationMessage For="@(() => ProductDto.CategoryId)" />
    </div>
    <div class="form-group">
        <label for="category">Brand</label>

        <select @bind="ProductDto.BrandId" class="form-control">
            <option value="">Select</option>
            @foreach (var brand in brands)
            {
                <option value="@brand.Id" selected="@ProductDto.BrandId">@brand.Name</option>
            }
        </select>
        <ValidationMessage For="@(() => ProductDto.BrandId)" />
    </div>
    <div class="form-group">
        <label for="stock">Stock</label>
        <input type="text" class="form-control" id="stock" @bind="ProductDto.AvailableStock" />
        <ValidationMessage For="@(() => ProductDto.AvailableStock)" />
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
    <button type="reset" class="btn btn-primary">Cancel</button>
    <button type="button" class="btn btn-primary" @onclick="NavigateToBack">Back</button>
</EditForm>